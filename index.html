<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>World Heritage Map</title>
    <style>
      #map {
        height: 100vh;
        width: 100%;
      }
    </style>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCZPRJzf-rbyrdjWjmJYWYpb74dnfLjkHw"></script>
    <script src="https://unpkg.com/@googlemaps/markerclusterer/dist/index.min.js"></script>
  </head>
  <body>
    <div id="map"></div>
    <script>
      const csvUrl = 'places.csv';
      const iconUrl = 'https://maps.google.com/mapfiles/ms2/micons/red-dot.png';
      let map;

      fetch(csvUrl)
        .then(response => response.text())
        .then(text => {
          const rows = text.trim().split('\n');
          const markers = [];

          rows.forEach((row, index) => {
            const [country, heritageName, latStr, lngStr, type] = row.split(',');
            const lat = parseFloat(latStr);
            const lng = parseFloat(lngStr);
            if (!isNaN(lat) && !isNaN(lng)) {
              const label = String(index + 1);
              const marker = new google.maps.Marker({
                position: { lat, lng },
                map: null,
                label: {
                  text: label,
                  color: "black",
                  fontSize: "12px",
                  fontWeight: "bold"
                },
                icon: {
                  url: iconUrl,
                  size: new google.maps.Size(32, 32),
                  scaledSize: new google.maps.Size(32, 32),
                  labelOrigin: new google.maps.Point(16, 10)
                },
                title: heritageName
              });

              const infoWindow = new google.maps.InfoWindow({
                content: `<strong>${heritageName}</strong><br>${country}`
              });

              marker.addListener('click', () => {
                infoWindow.open(map, marker);
              });

              markers.push(marker);
            }
          });

          map = new google.maps.Map(document.getElementById('map'), {
            center: { lat: 41.9028, lng: 12.4964 },
            zoom: 4,
            gestureHandling: 'greedy',
            disableDefaultUI: false
          });

          new markerClusterer.MarkerClusterer({ map, markers });
        })
        .catch(error => {
          console.error('CSV読み込みエラー:', error);
        });
    </script>
  </body>
</html>


